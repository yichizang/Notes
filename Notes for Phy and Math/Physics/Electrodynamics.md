---
banner: "![[mmexport1667206558778.png]]"
banner_y: 0.516
---

>[!abstract]- Pre-knowledge
>- [[Linear algebra]]
>- [[Vector analysis]]
>- Special function

>[!error]- Complaint
>The book *Classical Electrodynamics* written by J. D. Jackson is not recommanded for learning electrodynamics since there are many fuzzy parts and skipped contents.

# Electrodynamics
## 1 Electrostatics
---
### 1.1 Basic electrostatics
#### 1.1.1 Field equation
The *electric field* is a vector field $\pmb{E}$ that satisfies
$$
\begin{aligned}
\nabla\cdot\pmb{E}&=\frac{\rho}{\epsilon_0}\\
\nabla\times\pmb{E}&=\pmb{0},
\end{aligned}
$$
where $\rho$ is the charge density. The solution to these equations is the *Coulomb's law*
$$
\pmb{E}(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\ \rho(\pmb{\xi})\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$
When considering only point charge, the Coulomb's law becomes
$$
\pmb{E}(\pmb{x})=\frac{1}{4\pi\epsilon_0}\sum_iq_i\frac{\pmb{x}-\pmb{x}_i}{|\pmb{x}-\pmb{x}_i|^3}.
$$

#### 1.1.2 Electric potential
Since $\pmb{E}$ has zero curl, it can be written as a gradient
$$
\pmb{E}=-\nabla\varphi.
$$
This scalar field $\varphi$ is called the *electric potential*. It is determined up to a constant. It satisfies the *Poisson equation*
$$
\Delta\varphi=-\frac{\rho}{\epsilon_0}.
$$
When there is no charge in the area concerned, the eqation is called the *Laplace eqation*.

The solution to the Poisson equation is
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\frac{\rho(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}.
$$
When considering only point charge, it becomes
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\sum_i\frac{q_i}{|\pmb{x}-\pmb{x}_i|}.
$$
This is also called the Coulomb's law.

#### 1.1.3 Dipole
A dipole is two opposite point charge put close enough with each other. The dipole moment is
$$
\pmb{p}\doteq q\pmb{d},
$$
where $\pmb{d}$ points from the negative charge to the positive charge.

The potential of a dipole is
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\pmb{p}\cdot\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$
The electric field is then
$$
\pmb{E}(\pmb{x})=\frac{1}{4\pi\epsilon_0}\left[3(\pmb{x}-\pmb{\xi})\frac{\pmb{p}\cdot(\pmb{x}-\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|^5}-\frac{\pmb{p}}{|\pmb{x}-\pmb{\xi}|^3}\right].
$$

#### 1.1.4 Surface distribution of charge and dipole
For a surface distribution of charge $\sigma(\pmb{x})$ on $S$, the normal component of $\pmb{E}$ becomes discontinuous
$$
(\pmb{E}_2-\pmb{E}_1)\cdot\pmb{n}=\frac{\sigma}{\epsilon_0}.
$$
The tangential component of $\pmb{E}$ is still continuous here. The potential is also continuous, given by
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_S\mathrm{d}s\frac{\sigma(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}.
$$

A surface distribution of dipole $D(\pmb{x})$ can be viewed as two infinitely dense surface distributions of opposite charge getting infinitely close in the way that the dipole moment stays finite. Another way is to consider a surface distribution of dipole that are normal to the surface.

The potential generated by a surface distribution of dipole $D(\pmb{x})$ is
$$
\begin{aligned}
\varphi(\pmb{x})&=\frac{1}{4\pi\epsilon_0}\int_S\mathrm{d}\pmb{s}\cdot\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}D(\pmb{\xi})\\
&=-\frac{1}{4\pi\epsilon_0}\int_S\mathrm{d}\Omega\ D(\pmb{\xi}).
\end{aligned}
$$
The solid angle $\mathrm{d}\Omega$ has a positive sign when viewed from the inside. The potential is discontinuous on the surface
$$
\varphi_2-\varphi_1=\frac{D}{\epsilon_0}.
$$

#### 1.1.5 Energy and energy density
A point charge $q$ in an electric field has the potential energy of
$$
W=q\varphi.
$$
Therefore, for a system of point charges $\{q_i\}$, the total energy is given by
$$
\begin{aligned}
W&=\frac{1}{4\pi\epsilon_0}\sum_{j<i}\frac{q_iq_j}{|\pmb{x}_i-\pmb{x}_j|}\\
&=\frac{1}{8\pi\epsilon_0}\sum_{j\ne i}\frac{q_iq_j}{|\pmb{x}_i-\pmb{x}_j|}.
\end{aligned}
$$
Similarly, for a system of continuous charge density, the total energy is then
$$
\begin{aligned}
W&=\frac{1}{8\pi\epsilon_0}\iint\mathrm{d}^3x_1\mathrm{d}^3x_2\frac{\rho(\pmb{x}_1)\rho(\pmb{x}_2)}{|\pmb{x}_1-\pmb{x}_2|}\\
&=\frac{1}{2}\int\mathrm{d}^3x\ \rho(\pmb{x})\varphi(\pmb{x}).
\end{aligned}
$$
Applying the Poisson equation, one get
$$
W=-\frac{\epsilon_0}{2}\int\mathrm{d}^3x\ \varphi\Delta\varphi=\frac{\epsilon_0}{2}\int\mathrm{d}^3x|\nabla\varphi|^2=\frac{\epsilon_0}{2}\int\mathrm{d}^3x\ E^2.
$$
Therefore, one can define the *energy density* of electric field as
$$
w\doteq\frac{\epsilon_0}{2}E^2.
$$

Note that here the energy density is positive definite, while the total energy of point charges given above can be negative. This is because the integration includes self energy of the charges.

#### 1.1.6 Green's theorem
When considering a finite volumn $V$ with a closed boundary $S$, the Coulomb's potential is no longer the solution to the Poisson equation due to the extra boundary condition.

By applying the Gauss theorem to $\phi\nabla\psi$ where both $\phi$ and $\psi$ are scalar fields and using the fact that
$$
\nabla\psi\cdot\mathrm{d}\pmb{s}=\frac{\partial\psi}{\partial n}\mathrm{d}s,
$$
one get the *Green's first identity*
$$
\int_V\mathrm{d}^3x(\phi\Delta\psi+\nabla\phi\cdot\nabla\psi)=\oint_S\mathrm{d}s\ \phi\frac{\partial\psi}{\partial n}.
$$
When interchanging $\phi$ and $\psi$ and substract from above, one get the *Green's second identity* or *Green's theorem*
$$
\int_V\mathrm{d}^3x(\phi\Delta\psi-\psi\Delta\phi)=\oint_S\mathrm{d}s\left(\phi\frac{\partial\psi}{\partial n}-\psi\frac{\partial\phi}{\partial n}\right).
$$
Applying Green's theorem with $\psi=1/|\pmb{x}-\pmb{\xi}|$ and $\phi=\varphi(\pmb{x})$ and making use of the Poisson equation, one get
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\frac{\rho(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}+\frac{1}{4\pi}\oint_S\mathrm{d}s_\xi\left[\frac{1}{|\pmb{x}-\pmb{\xi}|}\frac{\partial\varphi}{\partial n_\xi}-\varphi(\pmb{\xi})\frac{\partial}{\partial n}\frac{1}{|\pmb{x}-\pmb{\xi}|}\right]
$$
for $\pmb{x}\in V$. For $\pmb{x}\notin V$, the right hand side of the equality is zero. Note that the last two terms can be viewed as a layer of surface charge $\sigma=\epsilon_0\partial_n\varphi$ and a layer of dipole $D=-\epsilon_0\varphi$.

#### 1.1.7 Green function
As a general case of $1/|\pmb{x}-\pmb{\xi}|$, define the *Green function* as a function $G(\pmb{x}_1,\pmb{x}_2)$ that satisfies
$$
\Delta_2G(\pmb{x}_1,\pmb{x}_2)=-4\pi\delta(\pmb{x}_1-\pmb{x}_2).
$$
The general form of Green function is
$$
G(\pmb{x}_1,\pmb{x}_2)=\frac{1}{|\pmb{x}_1-\pmb{x}_2|}+F(\pmb{x}_1,\pmb{x}_2),
$$
where $F(\pmb{x}_1,\pmb{x}_2)$ satisfies the Laplace equation.

Substituting $G(\pmb{x},\pmb{\xi})$ into the Green's theorem, one get
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\ \rho(\pmb{\xi})G(\pmb{x},\pmb{\xi})+\frac{1}{4\pi}\oint_S\mathrm{d}s_\xi\left[G(\pmb{x},\pmb{\xi})\frac{\partial\varphi}{\partial n_\xi}-\varphi(\pmb{\xi})\frac{\partial G}{\partial n_\xi}\right].
$$
The (simplest) *Dirichlet boundary condition* gives
$$
G(\pmb{x},\pmb{\xi}\in S)=0.
$$
The simplest *Neumann boundary condition* gives
$$
\frac{\partial}{\partial n_\xi}G(\pmb{x},\pmb{\xi}\in S)=-\frac{4\pi}{A},
$$
where $A$ is the surface area of $S$. Plug these conditions into the Green's theorem will give the corresponding solution.

---
### 1.2 Method of image
#### 1.2.1 Method of image
The *method of image* is a method to use certain (point) charge distribution outside the concerned region to simulate given boundary condition. Those charge are called *image charge*. One can then replace the problem with one concerning largar region, image charge and no boundary condition.

#### 1.2.2 Point charge and conductive sphere
Consider a point charge located at $\pmb{x}_0$ and a grounded conductive sphere $S$ located at the origin with radius $r_0$. That is a Dilichlet boundary condition of
$$
\varphi(|\pmb{x}|=r_0)=0.
$$

When the charge is outside the sphere $|\pmb{x}_0|>r_0$, the region of interest is the outside of $S$, so the image charge is inside $S$. Let it be located at $\pmb{x}_1$ and $\pmb{x}_1\parallel\pmb{x}_0$ due to symmetry. Then the boundary condition gives
$$
\varphi(\pmb{x}\in S)=\frac{1}{4\pi\epsilon_0}\left(\frac{q_0}{|\pmb{x}-\pmb{x}_0|}+\frac{q_1}{|\pmb{x}-\pmb{x}_1|}\right)_{|\pmb{x}|=r_0}=0.
$$
This implies that
$$
-\frac{q_1}{q_0}=\frac{x_1}{r_0}=\frac{r_0}{x_0},
$$
which gives the image charge. When the charge is inside the sphere, the image charge also satisfies the relation above. Knowing this, one can work out the surface charge density on the sphere
$$
\sigma(\pmb{x}\in S)=-\epsilon_0\frac{\partial\varphi}{\partial n}=-\frac{q_0}{4\pi x_0r_0}\frac{x_0^2-r_0^2}{|\pmb{x}_0-\pmb{x}|^3}.
$$
The force applied on the point charge is simply the Coulomb force between the point charge and the image charge
$$
\pmb{F}=-\frac{1}{4\pi\epsilon_0}\frac{q_0^2x_0r_0}{(x_0^2-r_0^2)^2}\frac{\pmb{x}_0}{|\pmb{x}_0|}.
$$

When the sphere is charged or insulated, then the field is the superposition of the field we get and the field of a point charge at the origin.

#### 1.2.3 Conductive sphere and uniform electric field
A uniform electric field can be thought of as electric field generated by two point charges $\pm q_0$ placed at $z=\mp R$ with $R\to\infty$ and $q_0\to\infty$ so that $q_0/R^2$ stays finite. In this way, the electric field is
$$
\pmb{E}=\frac{1}{4\pi\epsilon_0}\frac{2q_0}{R^2}\pmb{e}_z.
$$

Consider a conductive sphere located at the origin with radius $r_0$. The total field is the superposition of the field of actual charges and the field of image charges
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}q_0\left(\frac{1}{|\pmb{x}+\pmb{R}|}-\frac{1}{|\pmb{x}-\pmb{R}|}+\frac{-r_0/R}{|\pmb{x}+\frac{r_0^2}{R^2}\pmb{R}|}-\frac{-r_0/R}{|\pmb{x}-\frac{r_0^2}{R^2}\pmb{R}|}\right).
$$
Take the limit to infinity and express the result in spherical coordinates, one gets
$$
\varphi(r,\theta)=-|\pmb{E}|\left(r-\frac{r_0^3}{r^2}\right)\cos\theta.
$$
And the surface charge distribution is then
$$
\sigma(\theta)=-\epsilon_0\left.\frac{\partial\varphi}{\partial r}\right|_{r_0}=3\epsilon_0|\pmb{E}|\cos\theta.
$$

#### 1.2.4 Green function for sphere
To solve a general problem with potential boundary condition on a sphere, one can construct the Green function as
$$
G(\pmb{x}_1,\pmb{x}_2)=\frac{1}{|\pmb{x}_1-\pmb{x}_2|}-\frac{r_0/|\pmb{x}_2|}{|\pmb{x}_1-\frac{r_0^2}{x_2^2}\pmb{x}_2|}.
$$
It naturally satisfies the Dirichlet boundary condition $G(\pmb{x}_1,\pmb{x}_2\in S)=0$. Plugging this into the expression of Green theorem, one get the solution to Poisson equation outside the sphere
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int\mathrm{d}^3\xi\ \rho(\pmb{\xi})G(\pmb{x},\pmb{\xi})+\frac{1}{4\pi}\oint_S\mathrm{d}s_\xi\ \varphi(\pmb{\xi})\frac{x^2-\xi^2}{r_0|\pmb{x}-\pmb{\xi}|^3}.
$$
When considering the inside of the sphere, one simply needs to change the sign of the second integration.

---
### 1.3 Separation of variables
#### 1.3.1 Solution in Cartesian coordinate
The solution would be Fourior series.

---
### 1.4 Multipoles
#### 1.4.1 Multipole expansion
A *localized charge distribution* is the charge distribution $\rho(\pmb{x})$ that vanishes outside a sphere of radius $R$. A distribution that decayes faster than power can also be considered as a localized distribution at large enough distance. ^2629f2

The potential generated by a localized distribution can be expanded as
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\sum_{l=0}^\infty\sum_{m=-l}^l\frac{4\pi}{2l+1}q_{lm}\frac{Y_{lm}(\theta,\phi)}{r^{l+1}},
$$
called a *multipole expansion*. The $l=0$ term is called the *monopole* term, the $l=1$ terms *dipole* terms, etc.

#### 1.4.2 Multipole moment
The coefficient $q_{lm}$ is given by
$$
q_{lm}=\int\mathrm{d}\pmb{x}Y_{lm}^\ast(\theta,\phi)r^l\rho(\pmb{x}),
$$
called *multipole moment*. The first few coefficients under Cartesian coordinate are listed here.
| $l,m$ | $q_{lm}$                                                     | $q_{l,-m}$                                                   |
| ----- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $0,0$ | $\frac{1}{\sqrt{4\pi}}q$                                     |                                                              |
| $1,1$ | $-\sqrt{\frac{3}{8\pi}}(p_x-ip_y)$                           | $\sqrt{\frac{3}{8\pi}}(p_x+ip_y)$                            |
| $1,0$ | $\sqrt{\frac{3}{4\pi}}p_z$                                   |                                                              |
| $2,2$ | $\frac{1}{12}\sqrt{\frac{15}{2\pi}}(Q_{11}-2iQ_{12}-Q_{22})$ | $\frac{1}{12}\sqrt{\frac{15}{2\pi}}(Q_{11}+2iQ_{12}-Q_{22})$ |
| $2,1$ | $-\frac{1}{3}\sqrt{\frac{15}{8\pi}}(Q_{13}-iQ_{23})$         | $\frac{1}{3}\sqrt{\frac{15}{8\pi}}(Q_{13}+iQ_{23})$          |
| $2,0$ | $\frac{1}{2}\sqrt{\frac{5}{4\pi}}Q_{33}$                     |                                                              |
Here $q$ is the total charge, $\pmb{p}$ is the dipole moment
$$
\pmb{p}\doteq\int\mathrm{d}^3x\ \pmb{x}\rho(\pmb{x})
$$
and $Q_{ij}$ is the *traceless quadrupole moment*
$$
Q_{ij}\doteq\int\mathrm{d}^3x(3x_ix_j-x^2\delta_{ij})\rho(\pmb{x}).
$$
So that the expansion can also be written as
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\left(\frac{q}{|\pmb{x}|}+\frac{\pmb{p}\cdot\pmb{x}}{|\pmb{x}|^3}+\frac{Q_{ij}x^ix^j}{|\pmb{x}|^5}+\cdots\right).
$$

It can be proved that the lowest nonvanishing multipole moment of a distribution doesn't depend on the choice of origin and all higher terms do.

#### 1.4.3 Multipole expansion of energy
For a localized charge distribution $\rho(\pmb{x})$ in an external field $\varphi(\pmb{x})$, its total energy is given by
$$
W=\int\mathrm{d}^3x\rho(\pmb{x})\varphi(\pmb{x}).
$$
In the case when $\varphi(\pmb{x})$ varies slowly in the region of interest, it can be expanded as
$$
\varphi(\pmb{x})=\varphi(\pmb{0})+\pmb{x}\cdot\nabla\varphi(\pmb{0})+\frac{1}{2}x^ix^j\partial_i\partial_j\varphi(\pmb{0})+\cdots.
$$
Considering that for an external field $\Delta\varphi=0$, the energy can be written as
$$
W=q\varphi(\pmb{0})-\pmb{p}\cdot\pmb{E}(\pmb{0})-\frac{1}{6}Q_{ij}\partial_iE_j(\pmb{0}).
$$
This shows how multipoles interact with external field.

---
### 1.5 Ponderable media
#### 1.5.1 Macroscopic field
When considering ponderable media that have considerable response to electric field, one need to average over macroscopically small but microscopically large regions to get the macroscopic field.

For the equation of curl $\nabla\times\pmb{E}_{\text{micro}}=\pmb{0}$, the averaging doesn't change the form of it, namely
$$
\nabla\times\pmb{E}=\pmb{0}
$$
holds for macroscopic field.

#### 1.5.2 Polarization and displacement
When applying an external field to ponderable media, the charge distribution in the molecules or atoms will change to response. The dominant multipole moment here is dipole moment. Hence define the *electric polarization* as
$$
\pmb{P}(\pmb{x})=\frac{1}{V}\sum_i\pmb{p}_i,
$$
which is the average dipole moment per volumn. Here the sum over is in a macroscopically small region near $\pmb{x}$.

The potential is then
$$
\begin{aligned}
\varphi(\pmb{x})&=\frac{1}{4\pi\epsilon_0}\int\mathrm{d}^3\xi\left(\frac{\rho_f(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}+\pmb{P}\cdot\nabla_\xi\frac{1}{|\pmb{x}-\pmb{\xi}|}\right)\\
&=\frac{1}{4\pi\epsilon_0}\int\mathrm{d}^3\xi\frac{\rho_f(\pmb{\xi})-\nabla_\xi\cdot\pmb{P}(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|},
\end{aligned}
$$
where $\rho_f(\pmb{x})$ is the density of charges that are not generated by polarization of media, that is the *free charges*. With $\pmb{E}=-\nabla\varphi$, one get
$$
\nabla\cdot\pmb{E}=\frac{1}{\epsilon_0}(\rho_f-\nabla\cdot\pmb{P}).
$$
Define the *electric displacement* as
$$
\pmb{D}\doteq\epsilon_0\pmb{E}+\pmb{P}.
$$
Then one can write
$$
\nabla\cdot\pmb{D}=\rho_f.
$$

#### 1.5.3 Linear isotropic media
For a linear isotropic medium, the polarization induced by $\pmb{E}$ is
$$
\pmb{P}=\epsilon_0\chi_e\pmb{E},
$$
where the coefficient $\chi_e$ is called the *electric susceptibility* of the medium. The electric displacement is then
$$
\pmb{D}=\epsilon\pmb{E},
$$
where $\epsilon\doteq\epsilon_0(1+\chi_e)$ is called the *electric permittivity* and $\epsilon_r\doteq\epsilon/\epsilon_0$ is called the *relative electric permittivity*.

For uniform media where the $\epsilon$ is a constant over the space, the electric field then satisfies
$$
\nabla\cdot\pmb{E}=\frac{\rho_f}{\epsilon}.
$$
This implies that a point charge $q$ in an uniform medium can be corrected as a point charge of $q/\epsilon_r$ due to polarization around the charge.

#### 1.5.4 Plane boundary of dielectrics
Consider two semi-infinite dielectrics $\epsilon_1$ and $\epsilon_2$ placed at $z>0$ and $z<0$ respectively. A point charge $q_0$ is placed at $z=+R$. The electric field then satisfies the field equation
$$
\begin{aligned}
\epsilon_1\nabla\cdot\pmb{E}&=q\delta(\pmb{x}-\pmb{R}),&&z>0\\
\epsilon_2\nabla\cdot\pmb{E}&=0,&&z<0\\
\nabla\times\pmb{E}&=\pmb{0},
\end{aligned}
$$
and the boundary condition
$$
\lim_{z\to0^+}\begin{pmatrix}
\epsilon_1E_z\\
E_x\\
E_y
\end{pmatrix}=\lim_{z\to0^-}\begin{pmatrix}
\epsilon_2E_z\\
E_x\\
E_y
\end{pmatrix}.
$$
Since the polarization charge on the boundary plane is similar to those in the case of conductive plane, similar method of image can also be applied.

The field on the $\epsilon_1$ side can be considered as the superposition of field of the point charge (after correction) and an image charge $q_1$ at the symmetrical position. So does the field on the $\epsilon_2$ side except that the image charge is on the same side as the point charge. Thus the potential gives
$$
\varphi(\pmb{x})=\left\{\begin{aligned}
&\frac{1}{4\pi\epsilon_0}\left(\frac{q_0}{\epsilon_{1r}|\pmb{x}-\pmb{R}|}+\frac{q_1}{|\pmb{x}+\pmb{R}|}\right),&&z>0\\
&\frac{1}{4\pi\epsilon_0}\frac{q_0/\epsilon_{1r}+q_1}{|\pmb{x}-\pmb{R}|},&&z<0.
\end{aligned}\right.
$$
Using the boundary condition, one can work out
$$
q_1=\frac{\epsilon_1-\epsilon_2}{\epsilon_1+\epsilon_2}\frac{\epsilon_0}{\epsilon_1}q_0.
$$
The polarization charge distribution on the boundary can also be given as
$$
\sigma_{\text{p}}=\frac{q_0}{2\pi}\frac{\epsilon_0(\epsilon_1-\epsilon_2)}{\epsilon_1(\epsilon_1+\epsilon_2)}\frac{R}{(\rho^2+R^2)^{3/2}}.
$$

#### 1.5.5 Spherical boundary of dielectrics
Consider a dielectric sphere of radius $r_0$ with electric permittivity $\epsilon$ at the origin with uniform external field
$$
\pmb{E}=E_0\pmb{e}_z.
$$
The potential can then be written as
$$
\varphi(\pmb{x})=\left\{\begin{aligned}
&\sum_{l=0}^\infty A_lr^lP_l(\cos\theta),&&r<r_0\\
&\sum_{l=0}^\infty\left[B_lr^l+C_lr^{-(l+1)}\right]P_l(\cos\theta),&&r>r_0,
\end{aligned}\right.
$$
with boundary conditions
$$
\begin{aligned}
\varphi(\pmb{x})|_{\pmb{x}\to\infty}&=-\pmb{E}\cdot\pmb{x}=-E_0r\cos\theta,\\
-\frac{1}{r_0}\left.\frac{\partial\varphi}{\partial\theta}\right|_{r\to r_0^-}&=-\frac{1}{r_0}\left.\frac{\partial\varphi}{\partial\theta}\right|_{r\to r_0^+},\\
-\epsilon\left.\frac{\partial\varphi}{\partial r}\right|_{r\to r_0^-}&=-\epsilon_0\left.\frac{\partial\varphi}{\partial r}\right|_{r\to r_0^+}.
\end{aligned}
$$
The coefficients can therefore be determined as
$$
\begin{aligned}
A_1&=-\frac{3}{2+\epsilon_r}E_0,\\
B_1&=-E_0,\\
C_1&=\frac{\epsilon_r-1}{\epsilon_r+2}E_0,
\end{aligned}
$$
and the rest coefficients are $0$. The solution is then
$$
\varphi(\pmb{x})=\left\{\begin{aligned}
&-\frac{3}{\epsilon_r+2}E_0r\cos\theta,&&r<r_0\\
&-E_0r\cos\theta+\frac{\epsilon_r-1}{\epsilon_r+2}E_0\frac{r_0^3}{r^2}\cos\theta,&&r>r_0.
\end{aligned}\right.
$$
Inside the sphere, the electric field is uniform. Outside the sphere, the electric field is the superposition of $\pmb{E}$ and the electric field of a dipole
$$
\pmb{p}=4\pi\epsilon_0\frac{\epsilon_r-1}{\epsilon_r+2}r_0^3E_0.
$$
The polarization charge density on the surface is
$$
\sigma_{\text{p}}=3\epsilon_0\frac{\epsilon_r-1}{\epsilon_r+2}E_0\cos\theta.
$$

#### 1.5.6 Energy in dielectric media
For electric field in a dielectric medium, the total energy is given by
$$
W=\frac{1}{2}\int\mathrm{d}^3x\pmb{D}\cdot\pmb{E}.
$$
In the case of linear medium, it can also be written as
$$
W=\frac{1}{2}\int\mathrm{d}^3x\ \rho(\pmb{x})\varphi(\pmb{x}).
$$

The energy of a dielectric in an external field $\pmb{E}_0$ is
$$
W=-\frac{1}{2}\int\mathrm{d}^3x\pmb{P}\cdot\pmb{E}_0.
$$
Thus the force applied on the dielectric is
$$
F_i=-\left(\frac{\partial W}{\partial x^i}\right)_Q,
$$
where the lower script $Q$ means that the source of external field is fixed. In the case when the potential is fixed and consider only linear medium, the result becomes
$$
F_i=\left(\frac{\partial W}{\partial x^i}\right)_V.
$$

---
## 2 Magnetostatics
### 2.1 Basic magnetostatics
#### 2.1.1 Field equation
The *magnetic-flux density* is a vector field $\pmb{B}$ that satisfies the following equations
$$
\begin{aligned}
\nabla\cdot\pmb{B}&=0\\
\nabla\times\pmb{B}&=\mu_0\pmb{j},
\end{aligned}
$$
where $\pmb{j}$ is the current density. The solution to the field equation is the *Biot and Savart law*
$$
\pmb{B}(\pmb{x})=\frac{\mu_0}{4\pi}\int\mathrm{d}^3\xi\ \pmb{j}(\pmb{\xi})\times\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$
For line current, the solution becomes
$$
\pmb{B}(\pmb{x})=\frac{\mu_0}{4\pi}I\int\mathrm{d}\pmb{l}_\xi\times\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$

#### 2.1.2 Vector potential
Since $\pmb{B}$ has no divergence, it can be written as the curl of a vector field
$$
\pmb{B}=\nabla\times\pmb{A}.
$$
This vector field $\pmb{A}$ is called the *vector potential* of magnatic field. It is determined up to a gradient field. The way to fix $\pmb{A}$ is called *gauge*.

Under *Coulomb gauge* $\nabla\cdot\pmb{A}=0$, the vector potential satisfies the Poisson equation as well
$$
\Delta\pmb{A}=-\mu_0\pmb{j}.
$$
The solution is then
$$
\pmb{A}(\pmb{x})=\frac{\mu_0}{4\pi}\int\mathrm{d}^3\xi\frac{\pmb{j}(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}.
$$

#### 2.1.3 Magnetic dipole
A *magnetic dipole* is a small circular current loop. Its *magnetic dipole moment* is defined as
$$
\pmb{m}\doteq I\pmb{s}.
$$

The vector potential of $\pmb{m}$ is
$$
\pmb{A}(\pmb{x})=\frac{\mu_0}{4\pi}\pmb{m}\times\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$
The magnetic-flux density is then
$$
\pmb{B}(\pmb{x})=\frac{\mu_0}{4\pi}\left[3(\pmb{x}-\pmb{\xi})\frac{\pmb{m}\cdot(\pmb{x}-\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|^5}-\frac{\pmb{m}}{|\pmb{x}-\pmb{\xi}|^3}\right]+\frac{2\mu_0}{3}\pmb{m}\delta^{(3)}(\pmb{x}-\pmb{\xi}).
$$
Note that it's almost identical to the electric field of a dipole except for the last term. This is because the vector potential has a singularity point at the magnetic dipole.

#### 2.1.4 Energy of magnetic field
The energy of a current distribution $\pmb{j}(\pmb{x})$ under an external field is
$$
W=\frac{1}{2}\int\mathrm{d}^3x\ \pmb{j}\cdot\pmb{A}.
$$
Applying the field equation and the relation $\pmb{B}=\nabla\times\pmb{A}$, one can write the energy as
$$
W=\frac{1}{2\mu_0}\int\mathrm{d}^3x\ B^2.
$$

#### 2.1.5 Multipole expansion
For a localized current distribution which is defined similarly to [[Electrodynamics#^2629f2|localized charge distribution]], one can also define its magnetic moment as
$$
\pmb{m}=\frac{1}{2}\int\mathrm{d}^3x\ \pmb{x}\times\pmb{j}(\pmb{x}).
$$

Similar to the multipole expansion in electrostatics, one can expand the field of a localized current distribution as
$$
\pmb{A}(\pmb{x})=\frac{\mu_0}{4\pi}\int\mathrm{d}^3\xi\ \pmb{j}(\pmb{\xi})\left(\frac{1}{|\pmb{x}|}+\pmb{\xi}\cdot\nabla\frac{1}{|\pmb{x}|}+\frac{1}{2}\xi^i\xi^j\partial_i\partial_j\frac{1}{|\pmb{x}|}+\cdots\right).
$$
In magnetostatics, the current distribution satisfies
$$
\nabla\cdot\pmb{j}=0.
$$
Thus the first term is $0$. The leading term is then
$$
\pmb{A}^{(1)}(\pmb{x})=\frac{\mu_0}{4\pi}\frac{\pmb{m}\times\pmb{x}}{|\pmb{x}|^3}.
$$

The force and the torque recieved by the leading term of a localized current distribution, that is a magnetic moment, under external field $\pmb{B}(\pmb{x})$ is respectively
$$
\begin{aligned}
\pmb{F}&=(\pmb{m}\times\nabla)\times\pmb{B}(\pmb{0})=\nabla(\pmb{m}\cdot\pmb{B}),\\
\pmb{N}&=\pmb{m}\times\pmb{B}(\pmb{0}).
\end{aligned}
$$

---
### 2.2 Macroscopic media
#### 2.2.1 Macroscopic field
In the same way as averaging over the field equation of electric field to macroscopic scale, one can average the equation $\nabla\cdot\pmb{B}_{\text{micro}}=0$ into
$$
\nabla\cdot\pmb{B}=0,
$$
which means the concept of vector potential still works.

#### 2.2.2 Magnetization and magnetic field
In the same way as dealing with molecular polarizaion, one can define the *magnetization* as
$$
\pmb{M}(\pmb{x})\doteq\frac{1}{V}\sum_i\pmb{m}_i.
$$

The vector potential is then
$$
\begin{aligned}
\pmb{A}(\pmb{x})&=\frac{\mu_0}{4\pi}\int\mathrm{d}^3\xi\left[\frac{\pmb{j}_{f+p}(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}+\pmb{M}(\pmb{\xi})\times\nabla_\xi\frac{1}{|\pmb{x}-\pmb{\xi}|}\right]\\
&=\frac{\mu_0}{4\pi}\int\mathrm{d}^3\xi\frac{\pmb{j}_{f+p}(\pmb{\xi})+\nabla_\xi\times\pmb{M}(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}.
\end{aligned}
$$
Here the $\pmb{j}_{f+p}$ is the current density of free charge and polarization charge. It can be considered that $\nabla\times\pmb{M}$ contributes to an *effective current density*
$$
\pmb{j}_m\doteq\nabla\times\pmb{M}.
$$
Taking these currents into consideration, $\nabla\times\pmb{B}=\mu_0\pmb{j}$ can be written as
$$
\nabla\times\pmb{B}=\mu_0(\pmb{j}_{f+p}+\nabla\times\pmb{M}).
$$
In the similar way electric displacement is defined, one can define the *magnetic field*
$$
\pmb{H}\doteq\frac{1}{\mu_0}\pmb{B}-\pmb{M}.
$$
It satisfies
$$
\nabla\times\pmb{H}=\pmb{j}_{f+p}.
$$
In magnetostatics, $\pmb{j}_p$ is usually ignored.

#### 2.2.3 Types of media
In the simplest case of linear medium, one have
$$
\pmb{B}=\mu\pmb{H},
$$
where $\mu$ is called *magnetic permeability* of the medium. When $\mu>\mu_0$, the medium is called *paramagnetic* and when $\mu<\mu_0$ it is called *diamagnetic*.

*Ferromagnetic* medium is a type of nonlinear medium where
$$
\pmb{B}=f(\pmb{H}).
$$
Here the function $f$ is usually not even a single-valued function. It could depend on the history of the material.

#### 2.2.4 Methods for magnetostatics problems
When $\pmb{j}\ne\pmb{0}$, the general method is to use vector potential. If given $\pmb{H}=\pmb{H}(\pmb{B})$, then one can write
$$
\nabla\times\pmb{H}(\nabla\times\pmb{A})=\pmb{j}_f.
$$
In the case of linear medium, the equation becomes
$$
\nabla\times\left(\frac{1}{\mu}\nabla\times\pmb{A}\right)=\pmb{j}_f.
$$
When the medium is also uniform, the equation is similar to the [[Electrodynamics#2.1.2 Vector potential|vacuum case]] except that $\mu_0$ becomes $\mu$.

Another approach can be applied when $\pmb{j}=\pmb{0}$. Since $\nabla\times\pmb{H}=\pmb{0}$, it can be described by a scalar potential
$$
\pmb{H}=-\nabla\varphi_M.
$$
If $\pmb{B}=\pmb{B}(\pmb{H})$ is given, then the field equation is
$$
\nabla\cdot\pmb{B}(-\nabla\varphi_M)=0.
$$
In the case of linear medium, it becomes
$$
\nabla\cdot(\mu\nabla\varphi_M)=0.
$$

#### 2.2.5 Hard ferromagnets
*Hard ferromagnets* can be treated as materials with fixed $\pmb{M}(\pmb{x})$.

When it is attached with the condition $\pmb{j}=\pmb{0}$, both methods of vector potential and scalar potential can be used. When using vector potential, the fixed $\pmb{M}$ can be treated as effective current by
$$
\Delta\pmb{A}=-\mu_0\pmb{j}_m.
$$

When using scalar potential, the fixed $\pmb{M}$ can be treated as *effective magnetic-charge density*
$$
\rho_{\text{eff}}\doteq-\nabla\cdot\pmb{M}.
$$
The field equation is then
$$
\Delta\varphi_M=-\rho_{\text{eff}}.
$$

#### 2.2.6 Energy in media
In a general case of a medium, the total energy is given by
$$
W=\frac{1}{2}\int\mathrm{d}^3x\ \pmb{H}\cdot\pmb{B}.
$$
In the case of linear medium, it can also be written as
$$
W=\frac{1}{2}\int\mathrm{d}^3x\ \pmb{j}_f\cdot\pmb{A}.
$$

Similar to the electrostatic case, the energy of a medium placed in an external field is
$$
W=\frac{1}{2}\int\mathrm{d}^3x\ \pmb{M}\cdot\pmb{B}_0.
$$
Thus, when the source current is fixed, the force applied on the medium is
$$
F_i=\left(\frac{\partial W}{\partial x^i}\right)_{\pmb{j}}.
$$

---
## 3 Electromagnetism
### 3.1 Maxwell's equation
#### 3.1.1 Maxwell's equation
Consider the time dependence of field and charge distribution, the field equations mentioned above need to be corrected into the *Maxwell's equations*
$$
\begin{aligned}
\nabla\cdot\pmb{E}&=\frac{\rho}{\epsilon_0},\\
\nabla\times\pmb{E}&=-\frac{\partial\pmb{B}}{\partial t},\\
\nabla\cdot\pmb{B}&=\pmb{0},\\
\nabla\times\pmb{B}&=\mu_0\left(\pmb{j}+\epsilon_0\frac{\partial\pmb{E}}{\partial t}\right).
\end{aligned}
$$
The charges satisfies the *flow conservation equation*
$$
\nabla\cdot\pmb{j}+\frac{\partial\rho}{\partial t}=0,
$$
which can be derived from Maxwell's equations.

The $\epsilon_0\partial_t\pmb{E}$ term is called the *displacement current* $\pmb{j}_{\text{disp}}$, which reflects no actual charge movement but contributes to the curl of magnetic field as well.

#### 3.1.2 Maxwell's equation in media
When considering media, the Maxwell's equation can also be written as
$$
\begin{aligned}
\nabla\cdot\pmb{D}&=\rho_f,\\
\nabla\times\pmb{E}&=-\frac{\partial\pmb{B}}{\partial t},\\
\nabla\cdot\pmb{B}&=\pmb{0},\\
\nabla\times\pmb{H}&=\pmb{j}_f+\frac{\partial\pmb{D}}{\partial t}.
\end{aligned}
$$
From this one can derive the flow conservation equation of free charge. And one also have $\partial_t\pmb{D}=\pmb{j}_p+\pmb{j}_{\text{disp}}$.

#### 3.1.3 Potential
In the time-dependent case, $\nabla\cdot\pmb{B}=0$ still holds, thus one can still use vector potential to describe magnetic field
$$
\pmb{B}=\nabla\times\pmb{A}.
$$
On the other hand, one have
$$
\nabla\times\left(\pmb{E}+\frac{\partial\pmb{A}}{\partial t}\right)=\pmb{0}.
$$
So the electric field becomes
$$
\pmb{E}=-\nabla\varphi-\frac{\partial\pmb{A}}{\partial t}.
$$

The field equation of potential is
$$
\begin{aligned}
\Delta\varphi+\frac{\partial}{\partial t}\nabla\cdot\pmb{A}&=-\frac{\rho}{\epsilon_0},\\
\Delta\pmb{A}-\frac{1}{c^2}\frac{\partial^2\pmb{A}}{\partial t^2}-\nabla\left(\nabla\cdot\pmb{A}+\frac{1}{c^2}\frac{\partial\varphi}{\partial t}\right)&=-\mu_0\pmb{j}.
\end{aligned}
$$

#### 3.1.4 Gauge choice
The gauge degree of freedom remains here. One can choose the *Lorenz gauge*
$$
\nabla\cdot\pmb{A}-\frac{\partial\varphi}{\partial t}=0
$$
to obtain the following field equation of potentials
$$
\begin{aligned}
\Delta\varphi-\frac{1}{c^2}\frac{\partial^2\varphi}{\partial t^2}&=-\frac{\rho}{\epsilon_0},\\
\Delta\pmb{A}-\frac{1}{c^2}\frac{\partial^2\pmb{A}}{\partial t^2}&=-\mu_0\pmb{j}.
\end{aligned}
$$

---
### 3.2 Energy and momentum
#### 3.2.1 Energy of field and Poynting vector
Since magnetic force does not contribute to energy, the total work of a field on matter per unit time per unit volumn is given by
$$
\frac{\partial w_{\text{mat}}}{\partial t}=\pmb{E}\cdot\pmb{j}.
$$
Using Maxwell's equation, one can write the right-hand-side as
$$
\pmb{E}\cdot\pmb{j}=-\frac{1}{\mu_0}\nabla\cdot(\pmb{E}\times\pmb{B})-\frac{1}{2}\frac{\partial}{\partial t}\left(\epsilon_0E^2+\frac{1}{\mu_0}B^2\right).
$$
Comparing this to the energy density given in [[Electrodynamics#1.1.5 Energy and energy density|electrostatics]] and [[Electrodynamics#2.1.4 Energy of magnetic field|magnetostatics]], one can have the *energy flow density* $\pmb{S}$ and *energy density* $w$ as
$$
\begin{aligned}
&\pmb{S}\doteq\frac{1}{\mu_0}\pmb{E}\times\pmb{B},\\
&w\doteq\frac{1}{2}\left(\epsilon_0E^2+\frac{1}{\mu_0}B^2\right).
\end{aligned}
$$
Here $\pmb{S}$ is also called the *Poynting vector*. Clearly
$$
\frac{\partial w_{\text{mat}}}{\partial t}+\frac{\partial w}{\partial t}+\nabla\cdot\pmb{S}=0.
$$

#### 3.2.2 Momentum of field and Maxwell stress tensor
In analogue to the above derivation process, one can write the expression of momentum density of matter
$$
\frac{\partial\pmb{g}_{\text{mat}}}{\partial t}=\rho\pmb{E}+\pmb{j}\times\pmb{B}=\pmb{f}.
$$
Using Maxwell's equation again, one can write the right-hand-side as
$$
f^b=-\partial_a\left[\frac{1}{2}\left(\epsilon_0E^2+\frac{1}{\mu_0}B^2\right)\delta^{ab}-\epsilon_0E^aE^b-\frac{1}{\mu_0}B^aB^b\right]-\frac{1}{c^2}\partial_tS^b.
$$
Similar to the analyse of energy, one have the *momentum flow density tensor* $T^{ab}$ and *momentum density* $\pmb{g}$ as
$$
\begin{aligned}
&T^{ab}\doteq\frac{1}{2}\left(\epsilon_0E^2+\frac{1}{\mu_0}B^2\right)\delta^{ab}-\epsilon_0E^aE^b-\frac{1}{\mu_0}B^aB^b,\\
&\pmb{g}\doteq\frac{1}{c^2}\pmb{S}=\epsilon_0\pmb{E}\times\pmb{B}.
\end{aligned}
$$
The tensor $T^{ab}$ is also called *Maxwell stress tensor*. Consider a piece of matter in an electromagnatic field and a closed surface $\Sigma$ around it. The force applied on it is then given by
$$
f^b=\int_V\mathrm{d}^3x\frac{\partial g_{\text{mat}}^b}{\partial t}=-\oint_\Sigma\mathrm{d}s_aT^{ab}-\int_V\mathrm{d}^3x\frac{\partial g^b}{\partial t}.
$$

#### 3.2.3 Energy and momentum in media
With the presence of medium, there are additional polarization charges/currents and effective currents of magnetization. The interaction of electromagnetic field on these charges/currents also carry energy and momentum so that
$$
\begin{aligned}
\frac{\partial w_{\text{mat}}}{\partial t}&=(\pmb{j}_f+\pmb{j}_p+\pmb{j}_m)\cdot\pmb{E},\\
\frac{\partial\pmb{g}_{\text{mat}}}{\partial t}&=(\rho_f+\rho_p)\pmb{E}+(\pmb{j}_f+\pmb{j}_p+\pmb{j}_m)\times\pmb{B}.
\end{aligned}
$$
But this process is invertible, which means these energy and momentum are just stored in the medium temporarily. In this case, one can consider them still as energy and momentum of the field.

By this means, one can write the energy equation
$$
\frac{\partial w_{\text{mat}}}{\partial t}=\pmb{j}_f\cdot\pmb{E}=-\nabla\cdot\pmb{S}-\frac{\partial w}{\partial t},
$$
where
$$
\begin{aligned}
&\pmb{S}\doteq\pmb{E}\times\pmb{H},\\
&w\doteq\frac{1}{2}(\epsilon E^2+\mu H^2).
\end{aligned}
$$
The momentum equation can also be written as
$$
\frac{\partial g_{\text{mat}}^b}{\partial t}=(\rho_f\pmb{E}+\pmb{j}_f\times\pmb{B})^b=-\partial_aT^{ab}-\partial_tg^b,
$$
where
$$
\begin{aligned}
&T^{ab}\doteq\frac{1}{2}(E^cD_c+B^dH_d)\delta^{ab}-D^aE^b-B^aH^b,\\
&\pmb{g}\doteq\pmb{D}\times\pmb{B}.
\end{aligned}
$$

---
### 3.3 Quasi-static process
#### 3.3.1 Induction
According to Maxwell's equation, a time-dependent magnetic field will?

>[!note]
>Since time is running short for final exam, I'll skip this part for now. Sorry about that.

---
## 4 Electromagnetic wave
### 4.1 Wave equation
#### 4.1.1 Green function for wave equation
To solve a wave equation
$$
\Delta\psi-\frac{1}{c^2}\frac{\partial^2\psi}{\partial t^2}=f(\pmb{x},t),
$$
one perform a Fourior transformation to write
$$
\left(\Delta-k^2\right)\tilde{\psi}=-4\pi\tilde{f},
$$
where $k\doteq\omega/c$.