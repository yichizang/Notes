---
banner: "![[mmexport1667206558778.png]]"
banner_y: 0.516
---

>[!abstract]- Pre-knowledge
>- [[Linear algebra]]
>- [[Vector analysis]]
>- Special function

# Electrodynamics
## 1 Electrostatics
---
### 1.1 Basic electrostatics
#### 1.1.1 Field equation
The *electric field* is a vector field $\pmb{E}$ that satisfies
$$
\begin{aligned}
\nabla\cdot\pmb{E}&=\frac{\rho}{\epsilon_0}\\
\nabla\times\pmb{E}&=\pmb{0},
\end{aligned}
$$
where $\rho$ is the charge density. The solution to these equations is the *Coulomb's law*
$$
\pmb{E}(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\ \rho(\pmb{\xi})\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$
When considering only point charge, the Coulomb's law becomes
$$
\pmb{E}(\pmb{x})=\frac{1}{4\pi\epsilon_0}\sum_iq_i\frac{\pmb{x}-\pmb{x}_i}{|\pmb{x}-\pmb{x}_i|^3}.
$$

#### 1.1.2 Electric potential
Since $\pmb{E}$ has zero curl, it can be written as a gradient
$$
\pmb{E}=-\nabla\varphi.
$$
This scalar field $\varphi$ is called the *electric potential*. It is determined up to a constant. It satisfies the *Poisson equation*
$$
\Delta\varphi=-\frac{\rho}{\epsilon_0}.
$$
When there is no charge in the area concerned, the eqation is called the *Laplace eqation*.

The solution to the Poisson equation is
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\frac{\rho(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}.
$$
When considering only point charge, it becomes
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\sum_i\frac{q_i}{|\pmb{x}-\pmb{x}_i|}.
$$
This is also called the Coulomb's law.

#### 1.1.3 Dipole
A dipole is two opposite point charge put close enough with each other. The dipole moment is
$$
\pmb{p}\doteq q\pmb{d},
$$
where $\pmb{d}$ points from the negative charge to the positive charge.

The potential of a dipole is
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\pmb{p}\cdot\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$
The electric field is then
$$
\pmb{E}(\pmb{x})=\frac{1}{4\pi\epsilon_0}\left[3(\pmb{x}-\pmb{\xi})\frac{\pmb{p}\cdot(\pmb{x}-\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|^5}-\frac{\pmb{p}}{|\pmb{x}-\pmb{\xi}|^3}\right].
$$

#### 1.1.4 Surface distribution of charge and dipole
For a surface distribution of charge $\sigma(\pmb{x})$ on $S$, the normal component of $\pmb{E}$ becomes discontinuous
$$
(\pmb{E}_2-\pmb{E}_1)\cdot\pmb{n}=\frac{\sigma}{\epsilon_0}.
$$
The tangential component of $\pmb{E}$ is still continuous here. The potential is also continuous, given by
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_S\mathrm{d}s\frac{\sigma(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}.
$$

A surface distribution of dipole $D(\pmb{x})$ can be viewed as two infinitely dense surface distributions of opposite charge getting infinitely close in the way that the dipole moment stays finite. Another way is to consider a surface distribution of dipole that are normal to the surface.

The potential generated by a surface distribution of dipole $D(\pmb{x})$ is
$$
\begin{aligned}
\varphi(\pmb{x})&=\frac{1}{4\pi\epsilon_0}\int_S\mathrm{d}\pmb{s}\cdot\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}D(\pmb{\xi})\\
&=-\frac{1}{4\pi\epsilon_0}\int_S\mathrm{d}\Omega\ D(\pmb{\xi}).
\end{aligned}
$$
The solid angle $\mathrm{d}\Omega$ has a positive sign when viewed from the inside. The potential is discontinuous on the surface
$$
\varphi_2-\varphi_1=\frac{D}{\epsilon_0}.
$$

#### 1.1.5 Energy and energy density
A point charge $q$ in an electric field has the potential energy of
$$
W=q\varphi.
$$
Therefore, for a system of point charges $\{q_i\}$, the total energy is given by
$$
\begin{aligned}
W&=\frac{1}{4\pi\epsilon_0}\sum_{j<i}\frac{q_iq_j}{|\pmb{x}_i-\pmb{x}_j|}\\
&=\frac{1}{8\pi\epsilon_0}\sum_{j\ne i}\frac{q_iq_j}{|\pmb{x}_i-\pmb{x}_j|}.
\end{aligned}
$$
Similarly, for a system of continuous charge density, the total energy is then
$$
\begin{aligned}
W&=\frac{1}{8\pi\epsilon_0}\iint\mathrm{d}\tau_1\mathrm{d}\tau_2\frac{\rho(\pmb{x}_1)\rho(\pmb{x}_2)}{|\pmb{x}_1-\pmb{x}_2|}\\
&=\frac{1}{2}\int\mathrm{d}\tau\ \rho(\pmb{x})\varphi(\pmb{x}).
\end{aligned}
$$
Applying the Poisson equation, one get
$$
W=-\frac{\epsilon_0}{2}\int\mathrm{d}\tau\ \varphi\Delta\varphi=\frac{\epsilon_0}{2}\int\mathrm{d}\tau|\nabla\varphi|^2=\frac{\epsilon_0}{2}\int\mathrm{d}\tau\ E^2.
$$
Therefore, one can define the *energy density* of electric field as
$$
w\doteq\frac{\epsilon_0}{2}E^2.
$$

Note that here the energy density is positive definite, while the total energy of point charges given above can be negative. This is because the integration includes self energy of the charges.

#### 1.1.6 Green's theorem
When considering a finite volumn $V$ with a closed boundary $S$, the Coulomb's potential is no longer the solution to the Poisson equation due to the extra boundary condition.

By applying the Gauss theorem to $\phi\nabla\psi$ where both $\phi$ and $\psi$ are scalar fields and using the fact that
$$
\nabla\psi\cdot\mathrm{d}\pmb{s}=\frac{\partial\psi}{\partial n}\mathrm{d}s,
$$
one get the *Green's first identity*
$$
\int_V\mathrm{d}\tau(\phi\Delta\psi+\nabla\phi\cdot\nabla\psi)=\oint_S\mathrm{d}s\ \phi\frac{\partial\psi}{\partial n}.
$$
When interchanging $\phi$ and $\psi$ and substract from above, one get the *Green's second identity* or *Green's theorem*
$$
\int_V\mathrm{d}\tau(\phi\Delta\psi-\psi\Delta\phi)=\oint_S\mathrm{d}s\left(\phi\frac{\partial\psi}{\partial n}-\psi\frac{\partial\phi}{\partial n}\right).
$$
Applying Green's theorem with $\psi=1/|\pmb{x}-\pmb{\xi}|$ and $\phi=\varphi(\pmb{x})$ and making use of the Poisson equation, one get
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\frac{\rho(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}+\frac{1}{4\pi}\oint_S\mathrm{d}s_\xi\left[\frac{1}{|\pmb{x}-\pmb{\xi}|}\frac{\partial\varphi}{\partial n_\xi}-\varphi(\pmb{\xi})\frac{\partial}{\partial n}\frac{1}{|\pmb{x}-\pmb{\xi}|}\right]
$$
for $\pmb{x}\in V$. For $\pmb{x}\notin V$, the right hand side of the equality is zero. Note that the last two terms can be viewed as a layer of surface charge $\sigma=\epsilon_0\partial_n\varphi$ and a layer of dipole $D=-\epsilon_0\varphi$.

#### 1.1.7 Green function
As a general case of $1/|\pmb{x}-\pmb{\xi}|$, define the *Green function* as a function $G(\pmb{x}_1,\pmb{x}_2)$ that satisfies
$$
\Delta_2G(\pmb{x}_1,\pmb{x}_2)=-4\pi\delta(\pmb{x}_1-\pmb{x}_2).
$$
The general form of Green function is
$$
G(\pmb{x}_1,\pmb{x}_2)=\frac{1}{|\pmb{x}_1-\pmb{x}_2|}+F(\pmb{x}_1,\pmb{x}_2),
$$
where $F(\pmb{x}_1,\pmb{x}_2)$ satisfies the Laplace equation.

Substituting $G(\pmb{x},\pmb{\xi})$ into the Green's theorem, one get
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int_V\mathrm{d}^3\xi\ \rho(\pmb{\xi})G(\pmb{x},\pmb{\xi})+\frac{1}{4\pi}\oint_S\mathrm{d}s_\xi\left[G(\pmb{x},\pmb{\xi})\frac{\partial\varphi}{\partial n_\xi}-\varphi(\pmb{\xi})\frac{\partial G}{\partial n_\xi}\right].
$$
The (simplest) *Dirichlet boundary condition* gives
$$
G(\pmb{x},\pmb{\xi}\in S)=0.
$$
The simplest *Neumann boundary condition* gives
$$
\frac{\partial}{\partial n_\xi}G(\pmb{x},\pmb{\xi}\in S)=-\frac{4\pi}{A},
$$
where $A$ is the surface area of $S$. Plug these conditions into the Green's theorem will give the corresponding solution.

---
### 1.2 Method of image
#### 1.2.1 Method of image
The *method of image* is a method to use certain (point) charge distribution outside the concerned region to simulate given boundary condition. Those charge are called *image charge*. One can then replace the problem with one concerning largar region, image charge and no boundary condition.

#### 1.2.2 Point charge and conductive sphere
Consider a point charge located at $\pmb{x}_0$ and a grounded conductive sphere $S$ located at the origin with radius $r_0$. That is a Dilichlet boundary condition of
$$
\varphi(|\pmb{x}|=r_0)=0.
$$

When the charge is outside the sphere $|\pmb{x}_0|>r_0$, the region of interest is the outside of $S$, so the image charge is inside $S$. Let it be located at $\pmb{x}_1$ and $\pmb{x}_1\parallel\pmb{x}_0$ due to symmetry. Then the boundary condition gives
$$
\varphi(\pmb{x}\in S)=\frac{1}{4\pi\epsilon_0}\left(\frac{q_0}{|\pmb{x}-\pmb{x}_0|}+\frac{q_1}{|\pmb{x}-\pmb{x}_1|}\right)_{|\pmb{x}|=r_0}=0.
$$
This implies that
$$
-\frac{q_1}{q_0}=\frac{x_1}{r_0}=\frac{r_0}{x_0},
$$
which gives the image charge. When the charge is inside the sphere, the image charge also satisfies the relation above. Knowing this, one can work out the surface charge density on the sphere
$$
\sigma(\pmb{x}\in S)=-\epsilon_0\frac{\partial\varphi}{\partial n}=-\frac{q_0}{4\pi x_0r_0}\frac{x_0^2-r_0^2}{|\pmb{x}_0-\pmb{x}|^3}.
$$
The force applied on the point charge is simply the Coulomb force between the point charge and the image charge
$$
\pmb{F}=-\frac{1}{4\pi\epsilon_0}\frac{q_0^2x_0r_0}{(x_0^2-r_0^2)^2}\frac{\pmb{x}_0}{|\pmb{x}_0|}.
$$

When the sphere is charged or insulated, then the field is the superposition of the field we get and the field of a point charge at the origin.

#### 1.2.3 Conductive sphere and uniform electric field
A uniform electric field can be thought of as electric field generated by two point charges $\pm q_0$ placed at $z=\mp R$ with $R\to\infty$ and $q_0\to\infty$ so that $q_0/R^2$ stays finite. In this way, the electric field is
$$
\pmb{E}=\frac{1}{4\pi\epsilon_0}\frac{2q_0}{R^2}\pmb{e}_z.
$$

Consider a conductive sphere located at the origin with radius $r_0$. The total field is the superposition of the field of actual charges and the field of image charges
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}q_0\left(\frac{1}{|\pmb{x}+\pmb{R}|}-\frac{1}{|\pmb{x}-\pmb{R}|}+\frac{-r_0/R}{|\pmb{x}+\frac{r_0^2}{R^2}\pmb{R}|}-\frac{-r_0/R}{|\pmb{x}-\frac{r_0^2}{R^2}\pmb{R}|}\right).
$$
Take the limit to infinity and express the result in spherical coordinates, one gets
$$
\varphi(r,\theta)=-|\pmb{E}|\left(r-\frac{r_0^3}{r^2}\right)\cos\theta.
$$
And the surface charge distribution is then
$$
\sigma(\theta)=-\epsilon_0\left.\frac{\partial\varphi}{\partial r}\right|_{r_0}=3\epsilon_0|\pmb{E}|\cos\theta.
$$

#### 1.2.4 Green function for sphere
To solve a general problem with potential boundary condition on a sphere, one can construct the Green function as
$$
G(\pmb{x}_1,\pmb{x}_2)=\frac{1}{|\pmb{x}_1-\pmb{x}_2|}-\frac{r_0/|\pmb{x}_2|}{|\pmb{x}_1-\frac{r_0^2}{x_2^2}\pmb{x}_2|}.
$$
It naturally satisfies the Dirichlet boundary condition $G(\pmb{x}_1,\pmb{x}_2\in S)=0$. Plugging this into the expression of Green theorem, one get the solution to Poisson equation outside the sphere
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\int\mathrm{d}^3\xi\ \rho(\pmb{\xi})G(\pmb{x},\pmb{\xi})+\frac{1}{4\pi}\oint_S\mathrm{d}s_\xi\ \varphi(\pmb{\xi})\frac{x^2-\xi^2}{r_0|\pmb{x}-\pmb{\xi}|^3}.
$$
When considering the inside of the sphere, one simply needs to change the sign of the second integration.

---
### 1.3 Separation of variables
#### 1.3.1 Solution in Cartesian coordinate
The solution would be Fourior series.

---
### 1.4 Multipoles
#### 1.4.1 Multipole expansion
A *localized charge distribution* is the charge distribution $\rho(\pmb{x})$ that vanishes outside a sphere of radius $R$. A distribution that decayes faster than power can also be considered as a localized distribution at large enough distance.

The potential generated by a localized distribution can be expanded as
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\sum_{l=0}^\infty\sum_{m=-l}^l\frac{4\pi}{2l+1}q_{lm}\frac{Y_{lm}(\theta,\phi)}{r^{l+1}},
$$
called a *multipole expansion*. The $l=0$ term is called the *monopole* term, the $l=1$ terms *dipole* terms, etc.

#### 1.4.2 Multipole moment
The coefficient $q_{lm}$ is given by
$$
q_{lm}=\int\mathrm{d}\pmb{x}Y_{lm}^\ast(\theta,\phi)r^l\rho(\pmb{x}),
$$
called *multipole moment*. The first few coefficients under Cartesian coordinate are listed here.
| $l,m$ | $q_{lm}$                                                     | $q_{l,-m}$                                                   |
| ----- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| $0,0$ | $\frac{1}{\sqrt{4\pi}}q$                                     |                                                              |
| $1,1$ | $-\sqrt{\frac{3}{8\pi}}(p_x-ip_y)$                           | $\sqrt{\frac{3}{8\pi}}(p_x+ip_y)$                            |
| $1,0$ | $\sqrt{\frac{3}{4\pi}}p_z$                                   |                                                              |
| $2,2$ | $\frac{1}{12}\sqrt{\frac{15}{2\pi}}(Q_{11}-2iQ_{12}-Q_{22})$ | $\frac{1}{12}\sqrt{\frac{15}{2\pi}}(Q_{11}+2iQ_{12}-Q_{22})$ |
| $2,1$ | $-\frac{1}{3}\sqrt{\frac{15}{8\pi}}(Q_{13}-iQ_{23})$         | $\frac{1}{3}\sqrt{\frac{15}{8\pi}}(Q_{13}+iQ_{23})$          |
| $2,0$ | $\frac{1}{2}\sqrt{\frac{5}{4\pi}}Q_{33}$                     |                                                              |
Here $q$ is the total charge, $\pmb{p}$ is the dipole moment
$$
\pmb{p}\doteq\int\mathrm{d}^3x\ \pmb{x}\rho(\pmb{x})
$$
and $Q_{ij}$ is the *traceless quadrupole moment*
$$
Q_{ij}\doteq\int\mathrm{d}^3x(3x_ix_j-r^2\delta_{ij})\rho(\pmb{x}).
$$
So that the expansion can also be written as
$$
\varphi(\pmb{x})=\frac{1}{4\pi\epsilon_0}\left(\frac{q}{r}+\frac{\pmb{p}\cdot\pmb{x}}{r^3}+\frac{Q_{ij}x^ix^j}{r^5}+\cdots\right).
$$

It can be proved that the lowest nonvanishing multipole moment of a distribution doesn't depend on the choice of origin and all higher terms do.

#### 1.4.3 Multipole expansion of energy
For a localized charge distribution $\rho(\pmb{x})$ in an external field $\varphi(\pmb{x})$, its total energy is given by
$$
W=\int\mathrm{d}^3x\rho(\pmb{x})\varphi(\pmb{x}).
$$
In the case when $\varphi(\pmb{x})$ varies slowly in the region of interest, it can be expanded as
$$
\varphi(\pmb{x})=\varphi(\pmb{0})+\pmb{x}\cdot\nabla\varphi(\pmb{0})+\frac{1}{2}x^ix^j\partial_i\partial_j\varphi(\pmb{0})+\cdots.
$$
Considering that for an external field $\Delta\varphi=0$, the energy can be written as
$$
W=q\varphi(\pmb{0})-\pmb{p}\cdot\pmb{E}(\pmb{0})-\frac{1}{6}Q_{ij}\partial_iE_j(\pmb{0}).
$$
This shows how multipoles interact with external field.

---
### 1.5 Ponderable media
#### 1.5.1 Macroscopic field
When considering ponderable media that have considerable response to electric field, one need to average over macroscopically small but microscopically large regions to get the macroscopic field.

For the equation of curl $\nabla\times\pmb{E}_{\text{micro}}=\pmb{0}$, the averaging doesn't change the form of it, namely
$$
\nabla\times\pmb{E}=\pmb{0}
$$
holds for macroscopic field.

#### 1.5.2 Polarization and displacement
When applying an external field to ponderable media, the charge distribution in the molecules or atoms will change to response. The dominant multipole moment here is dipole moment. Hence define the *electric polarization* as
$$
\pmb{P}(\pmb{x})=\frac{1}{V}\sum_i\pmb{p}_i,
$$
which is the average dipole moment per volumn. Here the sum over is in a macroscopically small region near $\pmb{x}$.

The potential is then
$$
\begin{aligned}
\varphi(\pmb{x})&=\frac{1}{4\pi\epsilon_0}\int\mathrm{d}^3\xi\left(\frac{\rho_f(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}+\pmb{P}\cdot\nabla_\xi\frac{1}{|\pmb{x}-\pmb{\xi}|}\right)\\
&=\frac{1}{4\pi\epsilon_0}\int\mathrm{d}^3\xi\frac{\rho_f(\pmb{\xi})-\nabla_\xi\cdot\pmb{P}(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|},
\end{aligned}
$$
where $\rho_f(\pmb{x})$ is the density of charges that are not generated by polarization of media, that is the *free charges*. With $\pmb{E}=-\nabla\varphi$, one get
$$
\nabla\cdot\pmb{E}=\frac{1}{\epsilon_0}(\rho_f-\nabla\cdot\pmb{P}).
$$
Define the *electric displacement* as
$$
\pmb{D}\doteq\epsilon_0\pmb{E}+\pmb{P}.
$$
Then one can write
$$
\nabla\cdot\pmb{D}=\rho_f.
$$

#### 1.5.3 Linear isotropic media
For a linear isotropic medium, the polarization induced by $\pmb{E}$ is
$$
\pmb{P}=\epsilon_0\chi_e\pmb{E},
$$
where the coefficient $\chi_e$ is called the *electric susceptibility* of the medium. The electric displacement is then
$$
\pmb{D}=\epsilon\pmb{E},
$$
where $\epsilon\doteq\epsilon_0(1+\chi_e)$ is called the *electric permittivity* and $\epsilon_r\doteq\epsilon/\epsilon_0$ is called the *relative electric permittivity*.

For uniform media where the $\epsilon$ is a constant over the space, the electric field then satisfies
$$
\nabla\cdot\pmb{E}=\frac{\rho_f}{\epsilon}.
$$
This implies that a point charge $q$ in an uniform medium can be corrected as a point charge of $q/\epsilon_r$ due to polarization around the charge.

#### 1.5.4 Plane boundary of dielectrics
Consider two semi-infinite dielectrics $\epsilon_1$ and $\epsilon_2$ placed at $z>0$ and $z<0$ respectively. A point charge $q_0$ is placed at $z=+R$. The electric field then satisfies the field equation
$$
\begin{aligned}
\epsilon_1\nabla\cdot\pmb{E}&=q\delta(\pmb{x}-\pmb{R}),&&z>0\\
\epsilon_2\nabla\cdot\pmb{E}&=0,&&z<0\\
\nabla\times\pmb{E}&=\pmb{0},
\end{aligned}
$$
and the boundary condition
$$
\lim_{z\to0^+}\begin{pmatrix}
\epsilon_1E_z\\
E_x\\
E_y
\end{pmatrix}=\lim_{z\to0^-}\begin{pmatrix}
\epsilon_2E_z\\
E_x\\
E_y
\end{pmatrix}.
$$
Since the polarized charge on the boundary plane is similar to those in the case of conductive plane, similar method of image can also be applied.

The field on the $\epsilon_1$ side can be considered as the superposition of field of the point charge (after correction) and an image charge $q_1$ at the symmetrical position. So does the field on the $\epsilon_2$ side except that the image charge is on the same side as the point charge. Thus the potential gives
$$
\varphi(\pmb{x})=\left\{\begin{aligned}
&\frac{1}{4\pi\epsilon_0}\left(\frac{q_0}{\epsilon_{1r}|\pmb{x}-\pmb{R}|}+\frac{q_1}{|\pmb{x}+\pmb{R}|}\right),&&z>0\\
&\frac{1}{4\pi\epsilon_0}\frac{q_0/\epsilon_{1r}+q_1}{|\pmb{x}-\pmb{R}|},&&z<0.
\end{aligned}\right.
$$
Using the boundary condition, one can work out
$$
q_1=\frac{\epsilon_1-\epsilon_2}{\epsilon_1+\epsilon_2}\frac{\epsilon_0}{\epsilon_1}q_0.
$$
The polarized charge distribution on the boundary can also be given as
$$
\sigma_{\text{p}}=\frac{q_0}{2\pi}\frac{\epsilon_0(\epsilon_1-\epsilon_2)}{\epsilon_1(\epsilon_1+\epsilon_2)}\frac{R}{(\rho^2+R^2)^{3/2}}.
$$

#### 1.5.5 Spherical boundary of dielectrics
Consider a dielectric sphere of radius $r_0$ with electric permittivity $\epsilon$ at the origin with uniform external field
$$
\pmb{E}=E_0\pmb{e}_z.
$$
The potential can then be written as
$$
\varphi(\pmb{x})=\left\{\begin{aligned}
&\sum_{l=0}^\infty A_lr^lP_l(\cos\theta),&&r<r_0\\
&\sum_{l=0}^\infty\left[B_lr^l+C_lr^{-(l+1)}\right]P_l(\cos\theta),&&r>r_0,
\end{aligned}\right.
$$
with boundary conditions
$$
\begin{aligned}
\varphi(\pmb{x})|_{\pmb{x}\to\infty}&=-\pmb{E}\cdot\pmb{x}=-E_0r\cos\theta,\\
-\frac{1}{r_0}\left.\frac{\partial\varphi}{\partial\theta}\right|_{r\to r_0^-}&=-\frac{1}{r_0}\left.\frac{\partial\varphi}{\partial\theta}\right|_{r\to r_0^+},\\
-\epsilon\left.\frac{\partial\varphi}{\partial r}\right|_{r\to r_0^-}&=-\epsilon_0\left.\frac{\partial\varphi}{\partial r}\right|_{r\to r_0^+}.
\end{aligned}
$$
The coefficients can therefore be determined as
$$
\begin{aligned}
A_1&=-\frac{3}{2+\epsilon_r}E_0,\\
B_1&=-E_0,\\
C_1&=\frac{\epsilon_r-1}{\epsilon_r+2}E_0,
\end{aligned}
$$
and the rest coefficients are $0$. The solution is then
$$
\varphi(\pmb{x})=\left\{\begin{aligned}
&-\frac{3}{\epsilon_r+2}E_0r\cos\theta,&&r<r_0\\
&-E_0r\cos\theta+\frac{\epsilon_r-1}{\epsilon_r+2}E_0\frac{r_0^3}{r^2}\cos\theta,&&r>r_0.
\end{aligned}\right.
$$
Inside the sphere, the electric field is uniform. Outside the sphere, the electric field is the superposition of $\pmb{E}$ and the electric field of a dipole
$$
\pmb{p}=4\pi\epsilon_0\frac{\epsilon_r-1}{\epsilon_r+2}r_0^3E_0.
$$
The polarization charge density on the surface is
$$
\sigma_{\text{p}}=3\epsilon_0\frac{\epsilon_r-1}{\epsilon_r+2}E_0\cos\theta.
$$

#### 1.5.6 Energy in dielectric media
For electric field in a dielectric medium, the total energy is given by
$$
W=\frac{1}{2}\int\mathrm{d}^3x\pmb{D}\cdot\pmb{E}.
$$
In the case of linear medium, it can also be written as
$$
W=\frac{1}{2}\int\mathrm{d}^3x\ \rho(\pmb{x})\varphi(\pmb{x}).
$$

The energy of a dielectric in an external field $\pmb{E}_0$ is
$$
W=-\frac{1}{2}\int\mathrm{d}^3x\pmb{P}\cdot\pmb{E}_0.
$$
Thus the force applied on the dielectric is
$$
F_i=-\left(\frac{\partial W}{\partial x^i}\right)_Q,
$$
where the lower script $Q$ means that the source of external field is fixed. In the case when the potential is fixed and consider only linear medium, the result becomes
$$
F_i=\left(\frac{\partial W}{\partial x^i}\right)_V.
$$

---
## 2 Magnetostatics
### 2.1 Basic magnetostatics
#### 2.1.1 Field equation
The *magnetic field* is a vector field $\pmb{B}$ that satisfies the following equations
$$
\begin{aligned}
\nabla\cdot\pmb{B}&=0\\
\nabla\times\pmb{B}&=\mu_0\pmb{j},
\end{aligned}
$$
where $\pmb{j}$ is the current density. The solution to the field equation is the *Biot and Savart law*
$$
\pmb{B}(\pmb{x})=\frac{\mu_0}{4\pi}\int\mathrm{d}^3\xi\ \pmb{j}(\pmb{\xi})\times\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$
For line current, the solution becomes
$$
\pmb{B}(\pmb{x})=\frac{\mu_0}{4\pi}I\int\mathrm{d}\pmb{l}_\xi\times\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^3}.
$$

#### 2.1.2 Vector potential
Since $\pmb{B}$ has no divergence, it can be written as the curl of a vector field
$$
\pmb{B}=\nabla\times\pmb{A}.
$$
This vector field $\pmb{A}$ is called the *vector potential* of magnatic field. It is determined up to a gradient field. The way to fix $\pmb{A}$ is called *gauge*.

Under *Coulomb gauge* $\nabla\cdot\pmb{A}=0$, the vector potential satisfies the Poisson equation as well
$$
\Delta\pmb{A}=-\mu_0\pmb{j}.
$$
The solution is then
$$
\pmb{A}(\pmb{x})=\frac{\mu_0}{4\pi}\int\mathrm{d}^3\xi\frac{\pmb{j}(\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|}.
$$

#### 2.1.3 Magnetic dipole
A *magnetic dipole* is a small circular current loop. Its *magnetic dipole moment* is defined as
$$
\pmb{m}\doteq I\pmb{s}.
$$

The vector potential of $\pmb{m}$ is
$$
\pmb{A}(\pmb{x})=\frac{\mu_0}{4\pi}\pmb{m}\times\frac{\pmb{x}-\pmb{\xi}}{|\pmb{x}-\pmb{\xi}|^4}.
$$
The magnetic field is then
$$
\pmb{B}(\pmb{x})=\frac{\mu_0}{4\pi}\left[3(\pmb{x}-\pmb{\xi})\frac{\pmb{m}\cdot(\pmb{x}-\pmb{\xi})}{|\pmb{x}-\pmb{\xi}|^5}-\frac{\pmb{m}}{|\pmb{x}-\pmb{\xi}|^3}\right]+\frac{2\mu_0}{3}\pmb{m}\delta^{(3)}(\pmb{x}-\pmb{\xi}).
$$
Note that it's almost identical to the electric field of a dipole except for the last term. This is because the vector potential has a singularity point at the magnetic dipole.

For a localized current distribution, one can also define its magnetic moment as
$$
\pmb{m}=\frac{1}{2}\int\mathrm{d}^3x\ \pmb{x}\times\pmb{j}(\pmb{x}).
$$

#### 2.1.4 Localized current distribution under external field
